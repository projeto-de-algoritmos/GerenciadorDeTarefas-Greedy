<!DOCTYPE html>
<html>
<head>
	<title>Home</title>
	<meta charset="utf-8">
	<!--Bootstrap-->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

	<!-- Font -->
	<link href="https://fonts.googleapis.com/css?family=PT+Serif&display=swap" rel="stylesheet">

	<!-- JQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script src="https://code.jquery.com/color/jquery.color-2.1.2.js" type="text/javascript"></script>

	<link rel="stylesheet" href="styles.css"/>
	
</head>
<body>
	<h1 style="text-align: center;">Gerenciador de tarefas</h1>	

	<div id="tableDiv">
		<table id="tableTask"></table>
		<center>
			<button onclick="submitTask()" class="btn btn-primary" class="form-control" 
			style="margin-top: 50px;">Enviar</button>	
		</center>
		
	</div>
		
	<script>


		//Recuperação da entrada 
		let taskData = window.location.search;
		taskData = taskData.replace('?','');
		taskData = taskData.split('&');
		let qtdtask = parseInt(taskData[0]);
		let qtdsched = parseInt(taskData[1]);
		
		console.log(qtdtask);
		console.log(qtdsched);
		
		let taskDuration = [];
		let taskTable = [];
		for(let i = 0;i < qtdtask;i++){
			taskTable[i] = [];
			taskDuration[i] = 0;
			for(let j = 0;j < qtdsched;j++){
				taskTable[i][j] = false;
			}
		}

		createTable(qtdtask,qtdsched);
		animationSetup();

		function createTable(qtdtask,qtdsched) {
			let table = document.getElementById('tableTask');
			let row = table.insertRow(0);
			let cell = row.insertCell(0);
			cell.style.backgroundColor = 'rgba(0,191,255,1)';
			for(let i = 1;i < qtdsched + 1;i++){
				let cell = row.insertCell(i);
				cell.style.backgroundColor = 'rgba(0,191,255,1)';
				cell.innerHTML = `<strong>${i}ºHorário</strong>`;
			}
			
			for(let i = 1;i < qtdsched + 1;i++){
				row = table.insertRow(i);
				for(let j = 0;j < qtdtask + 1;j++){
					let cell = row.insertCell(j);
					if(j == 0){
						cell.innerHTML = `<input type="text" placeholder="Tarefa ${i}"></input>`;
						cell.style.backgroundColor = 'rgba(0,191,255,1)';
					}	
					else{
						cell.style.backgroundColor = 'white';
					}
				}
			}
		}

		function animationSetup(){
			//Hover na célula da tabela
			let colorPrev;
			$('td').hover(
				function() {
					let coordx = $(this).parent();//linha obj
					let coordy = $(this);//coluna obj
					coordx = coordx.index();
					coordy = coordy.index();
					colorPrev = this.style.backgroundColor;
					if(coordx > 0 && coordy > 0){
				    	$(this).animate({"background-color": "yellow"}, 50);
				    }
				}, 
				function() {
					let coordx = $(this).parent();
					let coordy = $(this);
					coordx = coordx.index();
					coordy = coordy.index();
					if(coordx > 0 && coordy > 0){
						$(this).animate({"background-color": colorPrev}, 0);
					}
				}
			);

			//Click na célula da tabela
			$('td').click(function() {
				let coordx = $(this).parent();
				let coordy = $(this);
				coordx = coordx.index();
				coordy = coordy.index();
					
				if(coordx > 0 && coordy > 0){
					$(this).css("border", "4px solid blue");
					
					taskDuration[coordx]++;
					taskTable[coordx][coordy] = true; 
					//$(this).css("background-color", "blue");
				}
				
			});

		}

	</script>
</body>
</html>